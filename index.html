<!DOCTYPE html>
<html>
<head>
  <title>CS 498 Final Project</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/vega/3.0.0-rc2/vega.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/vega-lite/2.0.0-beta.10/vega-lite.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/vega-embed/3.0.0-beta.19/vega-embed.js"></script>
 
</head>
<body>

<div id="option">
    <input name="About" 
           type="button" 
           value="About This Visualization" 
           onclick="about()" />
    <input name="Scene0Button" 
           type="button" 
           value="Scene 0" 
           onclick="Scene0()" />
    <input name="Scene1Button" 
           type="button" 
           value="Scene 1" 
           onclick="Scene1()" />	
    <input name="Scene2Button" 
           type="button" 
           value="Scene 2" 
           onclick="Scene2()" />	
    <input name="Scene3Button" 
           type="button" 
           value="Scene 3" 
           onclick="Scene3()" />		   
    <input name="EndButton" 
           type="button" 
           value="End" 
           onclick="Scene4()" />		   
</div>

<textarea id="textBox1" rows="50" cols="150" style ="border:none">
INTERACTIVE SLIDESHOW OF INSURANCE CUSTOMERS

DATA & BACKGROUND
The data set is from Kaggle, an analytics competition website. Basically, the data contain the number of insurance quotes that each of the 97,006 customers obtained before purchasing insurance. Each record contains demographic information about the policy holders at time of insurance purchase such as marital status, home ownership status, and their car value. 

HYBRID STRUCTURE 
For this narrative visualization, I use interactive slideshow to illustrate insurance customers by category (e.g., marital status) and by the number of quotes they get before purchasing insurance. Users could easily navigate the visualization in chronological order (Scene 0 through Scene 3) through clicking the buttons at the top of the webpage, with the contents under the “About this Visualization” button being the first things users see. By definition of interactive slideshow, users could investigate each scene further at their own pace (with the exception of Scene 0, which is an overview), which is discussed in the Parameter section of this write-up. 

SCENES
As noted in the HYBRID STRUCTURE section, this narrative visualization consists of 4 main scenes. All these scenes follow the same template, where the instructions are shown first, followed by a histogram. This layout is appropriate because in this simple visualization about customer distribution, users need instructions to navigate the scenes.  Also, the application and design are appropriate because each scene has only one histogram, which makes it easy for users to focus and analyze. The use of annotation and parameters are also appropriate, and they are discussed in more details under their respective sections. Here is a brief summary of the scenes.

Scene 0 – Distribution of insurance customers by the number of insurance quotes they obtained
Scene 1 – Similar to scene 0, further segmenting customers by their car value
Scene 2 – Similar to scene 1, further segmenting customers by their home ownership status
Scene 3 – Similar to scene 2, further segmenting customers by their marital status

ANNOTATIONS
By hovering the mouse over the bars in the histogram, an annotation box would appear to describe the number of customers in the bar the mouse points at. The annotation would clear as soon as the mouse has left the bar or users has moved onto another scene, and this is appropriate because the mouse no longer points at the data point of interest. To highlight certain data points, colors and bar height are used, because they are more illustrative. I thought about creating a text box to point out the maximum and minimum data points, but the boxes seem redundant. Lastly, all annotations follow the same template to show just the number of customers. 

PARAMETERS
On Scenes 1 through 3, users have an option to compare the number of customers of specific category, e.g., car value a on scene 1, across x axis using the toggle right under the histogram. This toggle is important because scenes 1 through 3 show stacked histograms, which make comparing the number of certain category of customers across the x-axis not easy. Once a choice has been made in the toggle, the histograms will be updated to show just the customers of the selected type relative to all the members across the x-axis. Please note that a parameter change will never lead to a scene change, because all the scenes have independent parameters. This structure is by design. 

TRIGGERS
The buttons along the top edge are the triggers of this narrative visualization. Each trigger represents a unique scene, and the trigger labels are self-explanatory. The buttons are placed in chronological order from left to right, so the users easily know the number and order of events in this narrative visualization.  

As noted in the Parameters section, scenes 1 through 3 have independent parameters. Therefore, moving from scene 1 to either scene 2 or 3 would only change the set of parameters for users to choose from, NOT the selected parameter value itself. 
</textarea>


<textarea id="textBox2" rows="10" cols="90" style ="border:none;display:none">
Instructions:

(1) Please click the buttons above to navigate through this narrative visualization.

(2) Please hover your mouse over the bars below to get the exact number of customers by category.

(3) To compare across the histogram bars, please select in the drop-down box under the histogram.
</textarea>

<p id="myspan" style ="color:blue;font-weight:bold; font-size:18pt"> </p>
<div id="vis"></div>
 
<script type="text/javascript">

var Scene_0 = {
  "$schema": "https://vega.github.io/schema/vega-lite/v2.json",
  "data": { "url": "https://raw.githubusercontent.com/panwong126/panwong126.github.io/master/data.json"},
  "width":500,
  "height":600,
  "mark": "bar",
  "encoding": {
    "x": {
      "field": "shopping_pt",
      "type": "nominal",
	  "axis": {"title": "# of Quotes Before Buying Insurance"}	  
    },
    "y": {
      "aggregate": "count",
      "type": "quantitative",
      "axis": {"title": "# of Customers"}
    },
	"tooltip": {"aggregate": "count", "type": "quantitative"}
  },
}


var Scene_1 = {
  "$schema": "https://vega.github.io/schema/vega-lite/v2.json",
  "data": { "url": "https://raw.githubusercontent.com/panwong126/panwong126.github.io/master/data.json"},
  "width":500,
  "height":600,
  "layer":[{
	"selection": {
		"parameter": {
		"type": "single",
		"fields": ["car_value"],
		"bind": {"input": "select", "options":["a","b","c","d","e","f","g","h","i"]}
		}
	},
	"mark": "bar",
	"encoding": {
    "y": {"aggregate": "count", "type": "quantitative","axis": {"title": "# of Customers"}},
    "x": {"field": "shopping_pt", "type": "nominal","axis": {"title": "# of Quotes Before Buying Insurance"}	  },
    "color": {
	  "value": "grey"
	},
	"tooltip": {"aggregate": "count", "type": "quantitative"}
  }
},{
    "transform": [{"filter": {"selection": "parameter"}}],
    "mark": "bar",
    "encoding": {
      "x": {"field": "shopping_pt", "type": "nominal"},
      "y": {"aggregate": "count", "type": "quantitative"},
      "color": {"field": "car_value", "type": "nominal"},
	  "tooltip": {"aggregate": "count", "type": "quantitative"}
    }
  }]}

var Scene_2 = {
  "$schema": "https://vega.github.io/schema/vega-lite/v2.json",
  "data": { "url": "https://raw.githubusercontent.com/panwong126/panwong126.github.io/master/data.json"},
  "width":500,
  "height":600,
  "layer":[{
	"selection": {
		"parameter": {
		"type": "single",
		"fields": ["homeowner"],
		"bind": {"input": "select", "options":[0,1]}
		}
	},
	"mark": "bar",
	"encoding": {
    "y": {"aggregate": "count", "type": "quantitative","axis": {"title": "# of Customers"}},
    "x": {"field": "shopping_pt", "type": "nominal","axis": {"title": "# of Quotes Before Buying Insurance"}	  },
    "color": {
	  "value": "grey"
	},
	"tooltip": {"aggregate": "count", "type": "quantitative"}
  }
},{
    "transform": [{"filter": {"selection": "parameter"}}],
    "mark": "bar",
    "encoding": {
      "x": {"field": "shopping_pt", "type": "nominal"},
      "y": {"aggregate": "count", "type": "quantitative"},
      "color": {"field": "homeowner", "type": "nominal","value": "steelblue"},
	  "tooltip": {"aggregate": "count", "type": "quantitative"}
    }
  }]}

var Scene_3 = {
  "$schema": "https://vega.github.io/schema/vega-lite/v2.json",
  "data": { "url": "https://raw.githubusercontent.com/panwong126/panwong126.github.io/master/data.json"},
  "width":500,
  "height":600,
  "layer":[{
	"selection": {
		"parameter": {
		"type": "single",
		"fields": ["married_couple"],
		"bind": {"input": "select", "options":[0,1]}
		}
	},
	"mark": "bar",
	"encoding": {
    "y": {"aggregate": "count", "type": "quantitative","axis": {"title": "# of Customers"}},
    "x": {"field": "shopping_pt", "type": "nominal","axis": {"title": "# of Quotes Before Buying Insurance"}	  },
    "color": {
	  "value": "grey"
	},
	"tooltip": {"aggregate": "count", "type": "quantitative"}
  }
},{
    "transform": [{"filter": {"selection": "parameter"}}],
    "mark": "bar",
    "encoding": {
      "x": {"field": "shopping_pt", "type": "nominal"},
      "y": {"aggregate": "count", "type": "quantitative"},
      "color": {"field": "married_couple", "type": "nominal","value": "steelblue"},
	  "tooltip": {"aggregate": "count", "type": "quantitative"}
    }
  }]}

function about(){
	document.getElementById("textBox1").style.display = "block"
	document.getElementById("textBox2").style.display = "none"
	document.getElementById("myspan").style.display = "none"
	document.getElementById("vis").style.display = "none"
}
  
function Scene0(){
	document.getElementById("textBox1").style.display = "none"
	document.getElementById("textBox2").style.display = "block"
	document.getElementById("myspan").innerHTML="Scene 0 - Distribution of Customers by # of Insurance Quotes";
	vega.embed("#vis", Scene_0);
	document.getElementById("vis").style.display = "block"
	document.getElementById("myspan").style.display = "block"
}
  
function Scene1(){
	document.getElementById("textBox1").style.display = "none"
	document.getElementById("textBox2").style.display = "block"
	document.getElementById("myspan").innerHTML="Scene 1 - Segmenting Customers by Car Value";
	vega.embed("#vis", Scene_1)
	document.getElementById("vis").style.display = "block"	
	document.getElementById("myspan").style.display = "block"	
}

function Scene2(){
	document.getElementById("textBox1").style.display = "none"
	document.getElementById("textBox2").style.display = "block"
	document.getElementById("myspan").innerHTML="Scene 2 - Segmenting Customers by Homeownership";
	vega.embed("#vis", Scene_2)
	document.getElementById("vis").style.display = "block"
	document.getElementById("myspan").style.display = "block"	
}

function Scene3(){
	document.getElementById("textBox1").style.display = "none"
	document.getElementById("textBox2").style.display = "block"
	document.getElementById("myspan").innerHTML="Scene 3 - Segmenting Customers by Marital Status";
	vega.embed("#vis", Scene_3)
	document.getElementById("vis").style.display = "block"	
	document.getElementById("myspan").style.display = "block"	
}

function Scene4(){
	document.getElementById("textBox1").style.display = "none"
	document.getElementById("textBox2").style.display = "none"
	document.getElementById("myspan").style.display = "none"
	document.getElementById("vis").style.display = "none"
	alert("Thanks for watching this narrative visualization.")
}


	
  </script>
</body>
</html>